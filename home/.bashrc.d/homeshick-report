if systemctl --user --quiet is-active homeshick-report.timer 2>/dev/null; then
	# systemctl is looking after homeshick reports, so no need to do
	# anything nasty and manual here.
	:
else
	homeshick-report () {
		command homeshick-report "$@" || return "$?"
		if (( $# == 0 )) || { (( $# == 1 )) && [[ "$1" = '-c' ]]; }; then
			# This was a full report, and we didn't hit the return
			# statement above, so everything was up-to-date.  Touch
			# the flag file to record the current time.
			touch ~/.homesick/.reportlastrun
		fi
	}

	if [[ ! -e ~/.homesick/.reportlastrun ]]; then
		echo "Could not work out when homeshick-report last had a clear run" >&2
	elif (( "$(file-age -f ~/.homesick/.reportlastrun)" >= 60*60*24*7 )); then
		# More than a week since this was last checked and found to be
		# all up-to-date.
		echo "homeshick-report hasn't had a clear run for $(file-age -h -- ~/.homesick/.reportlastrun)" >&2
	fi
fi

# vim: ft=bash noet ts=8
