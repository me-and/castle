#!/usr/bin/env bash
set -eu

cd "${HOMESHICK_DIR:-$HOME/.homesick/repos}"

if [[ -x homeshick/bin/homeshick ]]; then
	for repo in *; do
		status=0
		homeshick/bin/homeshick check -q "$repo" || status=$?
		case "$status" in
		0)
			printf '%s: up-to-date\n' "$repo"
			;;
		85)  # Ahead
			printf '%s: ahead\n' "$repo"
			;;
		86)  # Behind
			printf '%s: behind\n' "$repo"
			;;
		88)  # Modified
			printf '%s: modified\n' "$repo"
			;;
		*)
			printf '%s: unexpected status\n' "$repo"
			;;
		esac
	done
else
	printf 'Could not find homesick executable in %s\n' "$(pwd)"
fi
