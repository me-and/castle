#!/usr/bin/env bash
set -eu

cd "${HOMESHICK_DIR:-$HOME/.homesick/repos}"

if [[ -x homeshick/bin/homeshick ]]; then
	for repo in *; do
		printf '%s: ' "$repo"
		status=0
		homeshick/bin/homeshick check -q "$repo" || status=$?
		case "$status" in
		0)
			printf 'up-to-date\n'
			;;
		69)  # Unavailable
			printf 'could not check\n'
			;;
		85)  # Ahead
			printf 'ahead\n'
			;;
		86)  # Behind
			printf 'behind\n'
			;;
		88)  # Modified
			printf 'modified\n'
			;;
		*)
			printf 'unexpected status\n'
			;;
		esac
	done
else
	printf 'Could not find homesick executable in %s\n' "$(pwd)"
fi
